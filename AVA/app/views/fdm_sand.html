<style>
    
    /* قاب اسکرول جدول ماتریسی */
    .matrix-wrap {
        max-width: 100%;
        overflow: auto;
        position: relative
    }

    /* جدول ماتریسی با سلول‌های چسبان (sticky) */
    .matrix {
        border-collapse: separate;
        border-spacing: 0;
        font-size: 12px;
        min-width: 600px
    }

        .matrix th, .matrix td {
            border: 1px solid #ddd;
            padding: 4px 6px;
            white-space: nowrap
        }

        /* هدر بالا را ثابت نگه‌دار */
        .matrix thead th {
            position: sticky;
            top: 0;
            z-index: 5;
            background: #f9f9f9
        }

        /* ستون اول (نام CPT) را فریز کن */
        .matrix .sticky-col {
            position: sticky;
            left: 0;
            z-index: 6;
            background: #fff
        }

        .matrix thead .sticky-col {
            z-index: 7;
            background: #eee
        }
        /* خانه گوشه بالا-چپ */

        /* عرض‌ها: ستون اول پهن‌تر برای نام‌ها؛ بقیه هم‌اندازه و باریک */
        .matrix .sticky-col {
            width: 160px;
            min-width: 160px;
            max-width: 240px
        }

        .matrix td:not(.sticky-col), .matrix th.fo {
            width: 70px;
            min-width: 70px;
            max-width: 70px;
            text-align: right
        }

        /* ریز بهبودهای ظاهری */
        .matrix thead th {
            text-align: center
        }

    .muted-tip {
        font-size: 11px;
        color: #777;
        margin-top: 6px
    }
    /* اجازه‌ی چندخطی شدن فقط برای هدرهای FO */
    .matrix th.fo {
        white-space: normal !important; /* لغو nowrap عمومی */
        word-break: break-word; /* اگر واژه خیلی بلند بود بشکند */
        overflow-wrap: anywhere; /* هرجا لازم بود بشکند */
        text-align: center;
        line-height: 1.15;
        padding: 4px 6px;
    }
    /* ظرف داخلی لیبل، کمک به شکستن بهتر خطوط */
    .fo-label {
        display: block;
        line-height: 1.15;
        hyphens: auto; /* در صورت پشتیبانی مرورگر، هجّا بندی */
    }
    /* عرض ستون‌ها ثابت و باریک بماند (مثل قبل) */
    .matrix td:not(.sticky-col), .matrix th.fo {
        width: 70px;
        min-width: 70px;
        max-width: 70px; /* یا 60px اگر می‌خواهی باریک‌تر باشند */
    }

    .red {
        background: red !important;
    }

    .yellow {
        background: yellow !important;
    }

    .green {
        background: green !important;
    }
    /*.e-ganttchart .e-gantt-childtaskbar{
            background-color:transparent;
        }
        .e-ganttchart .e-gantt-childtaskbar, .e-ganttchart .e-gantt-parenttaskbar-innerdiv{
            border-style:none;
        }*/
    .e-gantt-template-progressbar {
        background: red !important;
        opacity: 1 !important;
    }

    .e-gantt-template-taskbar.schedule {
        background-color: #f0f0f0;
        color: #000;
    }

    .e-gantt-template-taskbar.takeoff {
        background-color: #00bfff;
        color: #fff;
    }

    .e-gantt-template-taskbar.landing {
        background-color: #3cb371;
        color: #fff;
    }

    .e-gantt-template-taskbar.cancel {
        background-color: #a65959;
        color: #fff;
    }

    .e-gantt-template-taskbar.delay {
        background-color: #ff0000;
        color: #fff;
    }

    .e-gantt-template-taskbar.inactive {
        background-color: #ffff00;
        color: #fff;
    }

    .e-gantt-template-taskbar.diverted {
        background-color: #ee82ee;
        color: #fff;
    }

    .e-gantt-template-taskbar.ground {
        background-color: #ff8000;
        color: #fff;
    }

    .e-gantt-template-taskbar.nodata {
        background-color: #787878;
        color: #fff;
    }

    .lbl_from, .lbl_to {
        font-size: 10px;
    }

    .dx-item.dx-scheduler-appointment.dx-scheduler-appointment-horizontal {
        height: 40px !important;
        background: white !important;
        margin: -3px 1px 0 1px;
    }

        .dx-item.dx-scheduler-appointment.dx-scheduler-appointment-horizontal.dx-state-focused {
            height: 40px !important;
            background: white !important;
            margin: -3px 1px 0 1px;
            border: none !important;
        }

    .dx-scheduler-work-space.dx-scheduler-work-space-month .dx-scheduler-date-table-cell {
        height: 67px !important;
    }

    .dx-scheduler-appointment.dx-state-focused:before {
        background-color: white !important;
    }

    .dx-scheduler-timeline .dx-scheduler-appointment.dx-state-focused:before,
    .dx-scheduler-work-space-month .dx-scheduler-appointment.dx-state-focused:before,
    .dx-scheduler-all-day-appointment.dx-state-focused:before {
        background-color: white !important;
    }



    .chartBox {
        border: 1px solid #e0e0e0;
        background-color: white;
    }

    #dg_flight_total .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_flight_total .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_flight_total .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_flight_total .dx-icon.dx-icon-export-excel-button {
        color: white;
    }




    #dg_flight .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_flight .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_flight .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_flight .dx-icon.dx-icon-export-excel-button {
        color: white;
    }


    .generalInfo {
        /*height: 205px;*/
        /*margin: 2px;*/
        /*width: 49.3%;*/
    }


    #dg_events .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_events .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_events .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_events .dx-icon.dx-icon-export-excel-button {
        color: white;
    }

    .dx-scrollable-native.dx-scrollable-vertical, .dx-scrollable-native.dx-scrollable-vertical .dx-scrollable-container {
        overflow-x: auto;
    }

    .thin-scroll3::-webkit-scrollbar {
        width: 2em;
        height: 2em;
    }

    .thin-scroll3::-webkit-scrollbar-thumb {
        background-color: #ddd;
        outline: 1px solid slategrey;
    }

    .phase-box {
        border: 1px solid #ccc;
        background: white;
        padding: 3px;
    }

    .phase-box-title {
    }

    .phase-box-score {
    }

    .phase-box-score-total {
    }

    .type-card {
        background: #ffffff;
        border: 0px solid #ccc;
        border-radius: 5px;
        padding: 0px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .type-header {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin-bottom: 0px;
        text-align: left;
    }
</style>

<div class="box fdm_sand" style="height:100%;display:none;overflow-y:hidden">


    <div ng-include="'app/views/header.html'" class="rowx header"></div>

    <div class="rowx content" style="clear:both">
        <div style="width:100%">
            <!-- TAB NAVIGATION -->
            <ul class="nav nav-tabs">
                <li style="width:20%;text-align:center" ng-class="{active: activeTab === 'overview'}">
                    <a style="color: white" ng-style="{'background-color': activeTab === 'overview' ? 'cadetblue' : 'gray'}" href="" ng-click="activeTab = 'overview'; instanceReferesh()">OverView</a>

                <li style="width:20%;text-align:center" ng-class="{active: activeTab === 'fleet'}">
                    <a style="color: white" ng-style="{'background-color': activeTab === 'fleet' ? 'cadetblue' : 'gray'}" href="" ng-click="activeTab = 'fleet'; instanceReferesh()">Fleet</a>
                </li>
                <li style="width: 20%; text-align: center" ng-class="{active: activeTab === 'pilots'}">
                    <a style="color: white" ng-style="{'background-color': activeTab === 'pilots' ? 'cadetblue' : 'gray'}" href="" ng-click="activeTab = 'pilots'; instanceReferesh()">Pilots</a>
                </li>
                <li style="width: 20%; text-align: center" ng-class="{active: activeTab === 'events'}">
                    <a style="color: white" ng-style="{'background-color': activeTab === 'events' ? 'cadetblue' : 'gray'}" href="" ng-click="activeTab = 'events'; instanceReferesh()">Events</a>
                </li>
                <li style="width: 20%; text-align: center" ng-class="{active: activeTab === 'routes'}">
                    <a style="color: white" ng-style="{'background-color': activeTab === 'routes' ? 'cadetblue' : 'gray'}" href="" ng-click="activeTab = 'routes'; instanceReferesh()">Routes</a>
                </li>
            </ul>
            <div dx-scroll-view="scroll_1">
                <!-- TAB CONTENT -->
                <div class="tab-content ">
                    <!-- TAB OverView -->
                    <div ng-show="activeTab === 'overview'">
                        <div class="row " style="padding:5px;">
                            <ul class="nav nav-tabs">
                                <li style="width:50%;text-align:center" ng-class="{active: activeTab2 === 'EWMA'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'EWMA' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'EWMA'">EWMA</a>
                                </li>
                                <li style="width: 50%; text-align: center" ng-class="{active: activeTab2 === 'MD'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'MD' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'MD'">MD</a>
                                </li>

                            </ul>

                            <div class="tab-content ">
                                <div ng-show="activeTab2 === 'EWMA'">
                                    <div class="row " style="padding:5px;">
                                        <div class="type-card">
                                            <div class="type-header" style="padding:7px;background:#eee;text-align:center">AllEvents</div>
                                            <div id="chart_ewma_all" dx-chart="allEWMAEventsChart"></div>
                                            <div id="chart_pareto_all" dx-chart="AllParetoChart"></div>
                                        </div>

                                    </div>


                                </div>

                                <div ng-show="activeTab2 === 'MD'">

                                </div>



                            </div>
                        </div>

                    </div>

                    <!-- TAB Fleet  -->
                    <div ng-show="activeTab === 'fleet'">
                        <div class="row " style="padding:5px;">
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card">
                                    <div class="type-header" style="padding:7px;background:#eee;text-align:center">B737</div>
                                    <div>
                                        <div class="col-lg-2 col-md-3" style="padding :0;">
                                            <div class="  generalInfo chartBox" style="height:140px">
                                                <p style="font-size: 16px; padding : 10px;margin:0;padding-bottom:0">Score per flight</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_737.score_per_flight}}</p>
                                            </div>
                                            <div class="  generalInfo chartBox" ng-click="showEvents()" style="height:140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Total Scores</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_737.total_score}}</p>
                                            </div>
                                            <div class="   generalInfo chartBox" style="height:140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Total Flights</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px ">{{ result_type_737.flight_count}}</p>
                                            </div>



                                            <div ng-show="false">

                                                <div class="col-lg-6 col-md-6 generalInfo" style="padding:0 !important">
                                                    <div class="chartBox" style="height: 102.5px">
                                                        <p style="font-size: 16px; padding-top: 5px; padding-left: 14px">Events per flight</p>
                                                        <p style="text-align: center; font-size: 20px">{{ result_type_737.flight_count.toFixed(0)}}</p>
                                                    </div>
                                                    <div class="chartBox" style="height: 102.5px">
                                                        <p style="font-size: 16px; padding-top: 5px; padding-left: 14px">Score per flight</p>
                                                        <p style="text-align: center; font-size: 20px">{{ result_type_737.flight_count.toFixed(0)}}</p>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>


                                        <div class="col-lg-8 col-md-6" style="padding:0; padding-right:0px;">
                                            <div class=" chartBox" style='padding-bottom:9px'>
                                                <div id="pie_737_total_event" dx-pie-chart="pie_737_total_event"></div>
                                            </div>

                                        </div>
                                        <div class="col-lg-2 col-md-3" style="padding :0;">
                                            <div class="  generalInfo chartBox" style="background: #d98c8c; height: 140px">
                                                <p style="font-size: 16px; padding : 10px;margin:0;padding-bottom:0">High Score</p>
                                                <p style="text-align: center; font-size: 30px;padding : 10px;margin:0;padding-bottom:15px;padding-top:25px">{{ result_type_737.high_score}}</p>
                                            </div>
                                            <div class="  generalInfo chartBox" style="background: #ffe699; height: 140px" ng-click="showEvents()">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Medium Score</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px ">{{ result_type_737.medium_score}}</p>
                                            </div>
                                            <div class="   generalInfo chartBox" style="background: #b3e6cc; height: 140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Low Score</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_737.low_score}}</p>
                                            </div>
                                        </div>
                                        <div style="clear:both"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6" style="padding: 0px; padding-top: 0px; padding-left: 5px">
                                <div class="type-card">
                                    <div class="type-header" style="padding:7px;background:#eee;text-align:center">MD</div>
                                    <div>
                                        <div class="col-lg-2 col-md-3" style="padding :0;">
                                            <div class="  generalInfo chartBox" style="height:140px">
                                                <p style="font-size: 16px; padding : 10px;margin:0;padding-bottom:0">Score per flight</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_md.score_per_flight}}</p>
                                            </div>
                                            <div class="  generalInfo chartBox" ng-click="showEvents()" style="height:140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Total Scores</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_md.total_score}}</p>
                                            </div>
                                            <div class="   generalInfo chartBox" style="height:140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Total Flights</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px ">{{ result_type_md.flight_count}}</p>
                                            </div>



                                            <div ng-show="false">

                                                <div class="col-lg-6 col-md-6 generalInfo" style="padding:0 !important">
                                                    <div class="chartBox" style="height: 102.5px">
                                                        <p style="font-size: 16px; padding-top: 5px; padding-left: 14px">Events per flight</p>
                                                        <p style="text-align: center; font-size: 20px">{{ result_type_md.flight_count.toFixed(0)}}</p>
                                                    </div>
                                                    <div class="chartBox" style="height: 102.5px">
                                                        <p style="font-size: 16px; padding-top: 5px; padding-left: 14px">Score per flight</p>
                                                        <p style="text-align: center; font-size: 20px">{{ result_type_md.flight_count.toFixed(0)}}</p>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="col-lg-8 col-md-6" style="padding:0; padding-right:0px;">
                                            <div class=" chartBox" style='padding-bottom:9px'>
                                                <div id="pie_md_total_event" dx-pie-chart="pie_md_total_event"></div>
                                            </div>

                                        </div>
                                        <div class="col-lg-2 col-md-3" style="padding :0;">
                                            <div class="  generalInfo chartBox" style="background: #d98c8c; height: 140px">
                                                <p style="font-size: 16px; padding : 10px;margin:0;padding-bottom:0">High Score</p>
                                                <p style="text-align: center; font-size: 30px;padding : 10px;margin:0;padding-bottom:15px;padding-top:25px">{{ result_type_md.high_score}}</p>
                                            </div>
                                            <div class="  generalInfo chartBox" style="background: #ffe699; height: 140px" ng-click="showEvents()">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Medium Score</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px ">{{ result_type_md.medium_score}}</p>
                                            </div>
                                            <div class="   generalInfo chartBox" style="background: #b3e6cc; height: 140px">
                                                <p style="font-size: 16px; padding: 10px; margin: 0; padding-bottom: 0 ">Low Score</p>
                                                <p style="text-align: center; font-size: 30px; padding: 10px; margin: 0; padding-bottom: 15px; padding-top: 25px">{{ result_type_md.low_score}}</p>
                                            </div>
                                        </div>
                                        <div style="clear:both"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear:both"></div>
                            <!--<div class="col-lg-3 col-md-3" style="padding :0;"></div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_type_comparison" dx-chart="bar_type_comparison"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3" style="padding :0;"></div>-->


                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_reg_737" dx-chart="bar_reg_737"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_reg_md" dx-chart="bar_reg_md"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear:both"></div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_cpt_737" dx-chart="bar_cpt_737"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_cpt_md" dx-chart="bar_cpt_md"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear:both"></div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_route_737" dx-chart="bar_route_737"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6" style="padding:0px;padding-top:0px;padding-right:5px">
                                <div class="type-card" style="margin-top:10px">
                                    <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                        <div id="bar_route_md" dx-chart="bar_route_md"></div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear:both"></div>


                        </div>
                    </div>
                    <!-- TAB pilots -->
                    <div ng-show="activeTab === 'pilots'">
                        <div class="row " style="padding:5px;">
                            <ul class="nav nav-tabs">
                                <li style="width:50%;text-align:center" ng-class="{active: activeTab2 === 'B737'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'B737' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'B737'">B737</a>
                                </li>
                                <li style="width: 50%; text-align: center" ng-class="{active: activeTab2 === 'MD'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'MD' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'MD'">MD</a>
                                </li>

                            </ul>

                            <div class="tab-content ">
                                <div ng-show="activeTab2 === 'B737'">
                                    <div style="padding:5px;overflow-y:auto;" ng-style="get_type_content_style()">
                                        <div ng-repeat="c in ds_cpt_737 track by (c.crew_id || $index)" class="col-lg-3" style="padding:5px" ng-click="go_crew(c)">
                                            <div style="border:1px solid #ccc">
                                                <div style="padding:7px;font-weight:bold;background:#ddd">{{c.crew_name}}</div>
                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">S/F</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight :bold;padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.score_per_flight}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Scores</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.total_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Flights</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 5px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{c.flight_count}}</p>
                                                    </div>

                                                </div>

                                                <div class="col-lg-8 col-md-6" style="padding:7px;">
                                                    <!----canvas id="chart-{{$index}}" width="100" height="60"></canvas-->
                                                    <canvas id="b737-chart-{{c.crew_id || $index}}" class="w-100" height="140"></canvas>

                                                </div>

                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox" style="background: #ffb3b3; ">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">H.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.high_score}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" style="background: #ffe6cc; " ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">M.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{ c.medium_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox" style="background: #ccfff2; ">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">L.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.low_score}}</p>
                                                    </div>
                                                </div>


                                                <div style="clear:both"></div>

                                            </div>


                                        </div>
                                    </div>
                                    <div style="clear:both"></div>
                                    <!-- all cpts comparison -->

                                    <div class="col-lg-12" style="padding:2px">
                                        <div class="chartBox" style="width:100%">
                                            <div id="chart_cpt_all" dx-chart="cpt_all_B737_chart"></div>
                                        </div>
                                    </div>
                                    <!-- Top Pairs — B737 -->
                                    <div class="type-card" style="margin-top:10px">
                                        <div class="type-header" style="padding:7px;background:#eee;text-align:center">Top Pairs — B737 (events per 100 flights)</div>
                                        <div style="padding:10px">
                                            <div ng-if="!pairs.list737.length" class="text-muted" style="padding:8px">داده‌ای برای B737 در این بازه نیست.</div>
                                            <canvas ng-if="pairs.list737.length" id="topPairsChartB737" style="width:100%;height:100%"></canvas>
                                        </div>
                                    </div>

                                    <!-- Matrix — B737 (CPT rows × FO columns) -->
                                    <div class="type-card" style="margin-top:10px">
                                        <div class="type-header" style="padding:7px;background:#eee;text-align:center">
                                            B737 — Matrix (CPT × FO) — /100 flights
                                        </div>

                                        <div class="matrix-wrap" style="padding:10px">
                                            <div ng-if="!pairs.matrix737.rows.length" class="text-muted" style="padding:8px">
                                                داده‌ای برای B737 در این بازه یافت نشد.
                                            </div>

                                            <table ng-if="pairs.matrix737.rows.length" class="matrix">
                                                <thead>
                                                    <tr>
                                                        <th class="sticky-col">CPT \ FO</th>
                                                        <th class="fo" ng-repeat="fo in pairs.matrix737.fos track by $index" ng-attr-title="{{fo}}">
                                                            <span class="fo-label">{{fo}}</span>
                                                        </th>
                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <tr ng-repeat="r in pairs.matrix737.rows track by $index">
                                                        <td class="sticky-col">{{r.cpt}}</td>
                                                        <td ng-repeat="fo in pairs.matrix737.fos track by $index" class="text-right">
                                                            {{ r[fo] == null ? '-' : (r[fo] | number:1) }}
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                            <div class="muted-tip">* برای خوانایی، حداکثر 20 CPT و 20 FO نمایش داده می‌شود.</div>
                                        </div>
                                    </div>



                                </div>

                                <div ng-show="activeTab2 === 'MD'">
                                    <div style="padding:5px;overflow-y:auto; " ng-style="get_type_content_style()">
                                        <div ng-repeat="c in ds_cpt_MD track by (c.crew_id || $index)" class="col-lg-3" style="padding:5px">
                                            <div style="border:1px solid #ccc">
                                                <div style="padding:7px;font-weight:bold;background:#ddd">{{c.crew_name}}</div>
                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">S/F</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight :bold;padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.score_per_flight}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Scores</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.total_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Flights</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 5px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{c.flight_count}}</p>
                                                    </div>

                                                </div>

                                                <div class="col-lg-8 col-md-6" style="padding:7px;">
                                                    <canvas id="md-chart-{{c.crew_id || $index}}" width="100" height="60"></canvas>
                                                </div>

                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox" style="background: #ffb3b3; ">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">H.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.high_score}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" style="background: #ffe6cc; " ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">M.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 05px ">{{ c.medium_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox" style="background: #ccfff2; ">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">L.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.low_score}}</p>
                                                    </div>
                                                </div>


                                                <div style="clear:both"></div>

                                            </div>


                                        </div>

                                    </div>

                                    <!-- all cpts comparison -->

                                    <div class="col-lg-12" style="padding:2px">
                                        <div class="chartBox" style="width:100%">
                                            <div id="chart_cpt_MD_all" dx-chart="cpt_all_MD_chart"></div>
                                        </div>
                                    </div>


                                    <div class="type-card" style="margin-top:10px">
                                        <div class="type-header" style="padding:7px;background:#eee;text-align:center">
                                            Top Pairs — MD (events per 100 flights)
                                        </div>
                                        <div style="height:420px;padding:10px">
                                            <div ng-if="!pairs.listMD.length" class="text-muted" style="padding:8px">داده‌ای برای MD در این بازه نیست.</div>
                                            <canvas ng-if="pairs.listMD.length" id="topPairsChartMD" style="width:100%;height:100%"></canvas>
                                        </div>
                                    </div>


                                    <div class="type-card" style="margin-top:10px">
                                        <div class="type-header" style="padding:7px;background:#eee;text-align:center">
                                            MD — Matrix (CPT × FO) — /100 flights
                                        </div>

                                        <div class="matrix-wrap" style="padding:10px">
                                            <div ng-if="!pairs.matrixMD.rows.length" class="text-muted" style="padding:8px">
                                                داده‌ای برای MD در این بازه یافت نشد.
                                            </div>

                                            <table ng-if="pairs.matrixMD.rows.length" class="matrix">
                                                <thead>
                                                    <tr>
                                                        <th class="sticky-col">CPT \ FO</th>
                                                        <th class="fo" ng-repeat="fo in pairs.matrixMD.fos track by $index" ng-attr-title="{{fo}}">
                                                            <span class="fo-label">{{fo}}</span>
                                                        </th>
                                                    </tr>
                                                </thead>

                                                <tbody>
                                                    <tr ng-repeat="r in pairs.matrixMD.rows track by $index">
                                                        <td class="sticky-col">{{r.cpt}}</td>
                                                        <td ng-repeat="fo in pairs.matrixMD.fos track by $index" class="text-right">
                                                            {{ r[fo] == null ? '-' : (r[fo] | number:1) }}
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                            <div class="muted-tip">* برای خوانایی، حداکثر 20 CPT و 20 FO نمایش داده می‌شود.</div>
                                        </div>
                                    </div>


                                </div>

                            </div>
                        </div>

                    </div>
                    <!--TAB EVENTS-->
                    <div ng-show="activeTab === 'events'">
                        <div class="row " style="padding:5px;">
                            <ul class="nav nav-tabs">
                                <li style="width:50%;text-align:center" ng-class="{active: activeTab2 === 'B737'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'B737' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'B737'">B737</a>
                                </li>
                                <li style="width: 50%; text-align: center" ng-class="{active: activeTab2 === 'MD'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'MD' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'MD'">MD</a>
                                </li>

                            </ul>

                            <div class="tab-content ">
                                <div ng-show="activeTab2 === 'B737'">
                                    <!--<div style="padding:5px;overflow-y:auto; " ng-style="get_type_content_style()">-->
                                    <div style="padding:5px;   ">
                                        <div class="col-lg-5" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_737" dx-chart="bar_events_737"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_737_regs" dx-chart="bar_events_737_regs"></div>
                                                    <div id="bar_events_737_phase" dx-chart="bar_events_737_phase"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-3" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_737_route" dx-chart="bar_events_737_route"></div>

                                                </div>
                                            </div>
                                        </div>
                                        <div style="clear:both"></div>

                                    </div>



                                </div>


                                <div ng-show="activeTab2 === 'MD'">
                                    <div style="padding:5px;   ">
                                        <div class="col-lg-5" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_md" dx-chart="bar_events_md"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_md_regs" dx-chart="bar_events_md_regs"></div>
                                                    <div id="bar_events_md_phase" dx-chart="bar_events_md_phase"></div>
                                                    <!-- <div id="bar_events_md_crew" dx-chart="bar_events_md_crew"></div>-->
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-3" style="padding:0px;padding-top:0px;padding-right:5px">
                                            <div class="type-card" style="margin-top:0px">
                                                <div class=" chartBox" style='padding: 10px 10px 10px 10px'>
                                                    <div id="bar_events_md_route" dx-chart="bar_events_md_route"></div>

                                                </div>
                                            </div>
                                        </div>
                                        <div style="clear:both"></div>

                                    </div>
                                </div>



                            </div>
                        </div>

                    </div>
                    <!--TAB ROUTS-->
                    <div ng-show="activeTab === 'routes'">
                        <div class="row " style="padding:5px;">
                            <ul class="nav nav-tabs">
                                <li style="width:50%;text-align:center" ng-class="{active: activeTab2 === 'B737'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'B737' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'B737'">B737</a>
                                </li>
                                <li style="width: 50%; text-align: center" ng-class="{active: activeTab2 === 'MD'}">
                                    <a style="color: white;padding:7px" ng-style="{'background-color': activeTab2 === 'MD' ? '#00ccff' : '#bfbfbf'}" href="" ng-click="activeTab2 = 'MD'">MD</a>
                                </li>

                            </ul>
                            <div class="tab-content ">
                                <div ng-show="activeTab2 === 'B737'">
                                    <div style="padding:5px;overflow-y:auto;" ng-style="get_type_content_style()">
                                        <div ng-repeat="c in ds_route_737 track by (c.crew_id || $index)" class="col-lg-3" style="padding:5px" ng-click="go_crew(c)">
                                            <div style="border:1px solid #ccc">
                                                <div style="padding:7px;font-weight:bold;background:#ddd">{{c.route}}</div>
                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">S/F</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight :bold;padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.score_per_flight}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Scores</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.total_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Flights</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 5px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{c.count}}</p>
                                                    </div>

                                                </div>

                                                <div class="col-lg-8 col-md-6" style="padding:7px;">
                                                    <canvas id="b737-route-chart-{{c.crew_id || $index}}" width="100" height="60"></canvas>
                                                </div>

                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox" style="background: #ffb3b3; ">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">H.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.high_score}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" style="background: #ffe6cc; " ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">M.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{ c.medium_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox" style="background: #ccfff2; ">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">L.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.low_score}}</p>
                                                    </div>
                                                </div>


                                                <div style="clear:both"></div>

                                            </div>


                                        </div>

                                    </div>
                                </div>
                                <div ng-show="activeTab2 === 'MD'">
                                    <div style="padding:5px;overflow-y:auto;" ng-style="get_type_content_style()">
                                        <div ng-repeat="c in ds_route_md track by (c.crew_id || $index)" class="col-lg-3" style="padding:5px" ng-click="go_crew(c)">
                                            <div style="border:1px solid #ccc">
                                                <div style="padding:7px;font-weight:bold;background:#ddd">{{c.route}}</div>
                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">S/F</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight :bold;padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.score_per_flight}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Scores</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.total_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">Flights</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 5px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{c.count}}</p>
                                                    </div>

                                                </div>

                                                <div class="col-lg-8 col-md-6" style="padding:7px;">
                                                    <canvas id="md-route-chart-{{c.crew_id || $index}}" width="100" height="60"></canvas>
                                                </div>

                                                <div class="col-lg-2 col-md-3" style="padding :0;">
                                                    <div class="  generalInfo chartBox" style="background: #ffb3b3; ">
                                                        <p style="font-size: 12px; padding : 5px;margin:0;padding-bottom:0">H.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.high_score}}</p>
                                                    </div>
                                                    <div class="  generalInfo chartBox" style="background: #ffe6cc; " ng-click="showEvents()">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">M.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px ">{{ c.medium_score}}</p>
                                                    </div>
                                                    <div class="   generalInfo chartBox" style="background: #ccfff2; ">
                                                        <p style="font-size: 12px; padding: 5px; margin: 0; padding-bottom: 0 ">L.S</p>
                                                        <p style="text-align: center; font-size: 14px; font-weight: bold; padding: 10px; margin: 0; padding-bottom: 10px; padding-top: 0px">{{ c.low_score}}</p>
                                                    </div>
                                                </div>


                                                <div style="clear:both"></div>

                                            </div>


                                        </div>

                                    </div>

                                </div>

                            </div>




                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="rowx footer">
        <div class=" col-lg-12 col-md-11 col-sm-11 col-xs-11" style="padding:0;">


            <table>
                <tr>
                    <td style="width:150px;text-align:right;padding-right:5px" class="dx-border"><div class="center" dx-date-box="date_from"></div></td>
                    <td style="width:150px;text-align:right;padding-right:5px" class="dx-border"><div class="center" dx-date-box="date_to"></div></td>

                    <td style="padding-right:3px;"> <div dx-button="btn_search"></div></td>

                </tr>
            </table>
        </div>
        <div style="clear:both"></div>
    </div>
    <div dx-load-panel="loadPanel"></div>
</div>
