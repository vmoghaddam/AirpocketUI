<style>
    .red {
        background: red !important;
    }

    .yellow {
        background: yellow !important;
    }

    .green {
        background: green !important;
    }
    /*.e-ganttchart .e-gantt-childtaskbar{
            background-color:transparent;
        }
        .e-ganttchart .e-gantt-childtaskbar, .e-ganttchart .e-gantt-parenttaskbar-innerdiv{
            border-style:none;
        }*/
    .e-gantt-template-progressbar {
        background: red !important;
        opacity: 1 !important;
    }

    .e-gantt-template-taskbar.schedule {
        background-color: #f0f0f0;
        color: #000;
    }

    .e-gantt-template-taskbar.takeoff {
        background-color: #00bfff;
        color: #fff;
    }

    .e-gantt-template-taskbar.landing {
        background-color: #3cb371;
        color: #fff;
    }

    .e-gantt-template-taskbar.cancel {
        background-color: #a65959;
        color: #fff;
    }

    .e-gantt-template-taskbar.delay {
        background-color: #ff0000;
        color: #fff;
    }

    .e-gantt-template-taskbar.inactive {
        background-color: #ffff00;
        color: #fff;
    }

    .e-gantt-template-taskbar.diverted {
        background-color: #ee82ee;
        color: #fff;
    }

    .e-gantt-template-taskbar.ground {
        background-color: #ff8000;
        color: #fff;
    }

    .e-gantt-template-taskbar.nodata {
        background-color: #787878;
        color: #fff;
    }

    .lbl_from, .lbl_to {
        font-size: 10px;
    }

    .dx-item.dx-scheduler-appointment.dx-scheduler-appointment-horizontal {
        height: 40px !important;
        background: white !important;
        margin: -3px 1px 0 1px;
    }

        .dx-item.dx-scheduler-appointment.dx-scheduler-appointment-horizontal.dx-state-focused {
            height: 40px !important;
            background: white !important;
            margin: -3px 1px 0 1px;
            border: none !important;
        }

    .dx-scheduler-work-space.dx-scheduler-work-space-month .dx-scheduler-date-table-cell {
        height: 67px !important;
    }

    .dx-scheduler-appointment.dx-state-focused:before {
        background-color: white !important;
    }

    .dx-scheduler-timeline .dx-scheduler-appointment.dx-state-focused:before,
    .dx-scheduler-work-space-month .dx-scheduler-appointment.dx-state-focused:before,
    .dx-scheduler-all-day-appointment.dx-state-focused:before {
        background-color: white !important;
    }



    .chartBox {
        border: 1px solid #e0e0e0;
        background-color: white;
    }

    #dg_flight_total .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_flight_total .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_flight_total .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_flight_total .dx-icon.dx-icon-export-excel-button {
        color: white;
    }

    #dg_flight .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_flight .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_flight .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_flight .dx-icon.dx-icon-export-excel-button {
        color: white;
    }


    .generalInfo {
        /*height: 205px;*/
        /*margin: 2px;*/
        /*width: 49.3%;*/
    }


    #dg_events .dx-datagrid-header-panel {
        padding: 0;
        background-color: gray;
        color: white;
    }

        #dg_events .dx-datagrid-header-panel .dx-toolbar {
            margin: 0;
            padding-right: 20px;
            background-color: transparent;
            padding-left: 10px;
        }

        #dg_events .dx-datagrid-header-panel .dx-toolbar-items-container {
            height: 35px;
        }

    #dg_events .dx-icon.dx-icon-export-excel-button {
        color: white;
    }

    .dx-scrollable-native.dx-scrollable-vertical, .dx-scrollable-native.dx-scrollable-vertical .dx-scrollable-container {
        overflow-x: auto;
    }

    .thin-scroll3::-webkit-scrollbar {
        width: 2em;
        height: 2em;
    }

    .thin-scroll3::-webkit-scrollbar-thumb {
        background-color: #ddd;
        outline: 1px solid slategrey;
    }

    .phase-box {
        border: 1px solid #ccc;
        background: white;
        padding: 3px;
    }

    .phase-box-title {
    }

    .phase-box-score {
    }

    .phase-box-score-total {
    }

    .type-card {
        background: #ffffff;
        border: 0px solid #ccc;
        border-radius: 5px;
        padding: 0px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .type-header {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin-bottom: 0px;
        text-align: left;
    }
</style>

<div class="box zfdm_crew" style="height:100%;display:none;overflow-y:hidden">


    <div ng-include="'app/views/header.html'" class="rowx header"></div>
    <div class="rowx content" style="clear:both">
        <div dx-scroll-view="scroll_1">
            <div style="width:100%">
                <div>
                    <!--<div class="col-lg-3" style="padding:2px">
            <div class="chartBox" style="width:100%">
                <div dx-pie-chart="pie_event"></div>
            </div>
        </div>-->
                    <div style="padding:5px;background:#ccc;margin-bottom:7px;text-align:center;font-weight:bold">
                        {{crew_name}}
                    </div>
                    <div class="col-lg-1" style="padding:2px">
                        <div style="padding: 2px; height: 100px">
                            <div class="chartBox" style="width: 100%; height: 100%">
                                <p style="text-align: center; font-size: 16px; padding-top: 5px">Flights</p>
                                <p style="text-align: center; font-size: 30px">{{result_type_crew.flight_count}}</p>
                            </div>
                        </div>

                        <div style="padding: 2px; height: 100px">
                            <div class="chartBox" style="width: 100%;height:100%">
                                <p style="text-align: center; font-size: 16px; padding-top: 5px">Events</p>
                                <p style="text-align: center; font-size: 30px">{{result_type_crew.count}}</p>
                            </div>
                        </div>
                        <div style="padding: 2px; height:100px">
                            <div class="chartBox" style="width:100%;height:100%">
                                <p style="text-align: center; font-size: 16px; padding-top: 5px">Scores</p>
                                <p style="text-align: center; font-size: 30px">{{result_type_crew.total_score}}</p>
                            </div>
                        </div>
                        <div style="padding: 2px; height:100px">
                            <div class="chartBox" style="width:100%;height:100%">
                                <p style="text-align: center; font-size: 16px; padding-top: 5px">Score per flight</p>
                                <p style="text-align: center; font-size: 30px">{{result_type_crew.score_per_flight.toFixed(2)}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3" style="padding:2px">
                        <div class="chartBox" style="width:100%">
                            <div id="pie_score" dx-pie-chart="pie_score"></div>
                        </div>
                    </div>
                    <div class="col-lg-4" style="padding:2px">
                        <div class="chartBox" style="width:100%">
                            <div id="bar_phase" dx-chart="bar_phase"></div>
                        </div>
                    </div>
                    <div class="col-lg-4" style="padding:2px">
                        <div class="chartBox" style="width:100%">
                            <div id="bar_register" dx-chart="bar_register"></div>
                        </div>
                    </div>
                    <!--<div class="col-lg-3" style="padding:2px">
            <div class="chartBox" style="width:100%">
                <div dx-pie-chart="pie_score_phase"></div>
            </div>
        </div>-->

                </div>

                <div style="clear:both"></div>
                <div class="col-lg-12" style="padding:2px">
                    <div class="chartBox" style="width:100%">

                        <div id="chart_pareto_captain" dx-chart="CaptainParetoChart"></div>
                        <div id="chart_description" style="font-size:13px;color:#444;margin:10px 12px 18px 12px;line-height:1.5;">
                            <strong>How to read this chart</strong><br />
                            • <strong>Bars (Count)</strong>: Show the individual number of occurrences for each event type. Taller bars represent more frequent events.<br />
                            • <strong>Line (Cumulative %)</strong>: Shows the running total percentage of all events as you move from left to right. It identifies how many event types make up the majority of problems.<br />
                            • <strong>The "Vital Few"</strong>: Events on the left side of the chart are your most frequent types. Focusing improvement efforts on these few areas will address the largest portion of total events, following the <strong>Pareto Principle (80/20 Rule)</strong>.<br />
                            • <strong>Recommended action</strong>: Prioritize investigation and corrective actions for the event types at the beginning of the chart (the tallest bars). Addressing the top 3-5 categories will likely resolve a significant majority (60-80%) of all reported events.<br />
                            • <strong>Parameters reference</strong>: Events are sorted by frequency in descending order. Cumulative percentage calculated as running total of individual percentages.
                        </div>
                    </div>
                </div>


                <!--<div style="clear:both"></div>
    <div class="col-lg-12" style="padding:2px">
        <div class="chartBox" style="width:100%">
            <div id="bar_event" dx-chart="bar_event"></div>
        </div>
    </div>-->


                <div style="clear:both"></div>

                <div class="col-lg-4" style="padding:2px">
                    <div class="chartBox" style="width:100%">
                        <div id="bar_route" dx-chart="bar_route"></div>
                    </div>
                </div>

                <!-- NEW: CPT–FO chart (right side of Route) -->
                <div class="col-lg-8" style="padding:2px">
                    <div class="chartBox" style="width:100%">
                        <div id="bar_cpt_fo" dx-chart="bar_cpt_fo"></div>
                    </div>
                </div>

                <div style="clear:both"></div>
                <div class="col-lg-12" style="padding:2px">
                    <div class="chartBox" style="width:100%">
                        <div id="cpt_month_mix" dx-chart="cpt_month_mix"></div>
                    </div>
                </div>
                <div style="clear:both"></div>
                <div class="col-lg-12" style="padding:2px">
                    <div class="chartBox" style="width:100%">
                        <div id="chart_ewma_captain" dx-chart="CaptainEWMAEventsChart"></div>
                        <div id="chart_description" style="font-size:13px;color:#444;margin:10px 12px 18px 12px;line-height:1.5;">
                            <strong>How to read this chart</strong><br />
                            • <span style="color:#2f6fbf">Blue line (EWMA, α = 0.30)</span>: smoothed trend of daily FDM event rate per 100 flights. Smooths out daily fluctuations while highlighting emerging trends. An upward trend indicates increasing risk; downward or flat trend indicates stable or improving performance.<br />
                            • <span style="color:#d9534f">Red triangles (Alarms)</span>: days when <strong>CUSUM-positive</strong> exceeds threshold (kFactor = 0.50 × σ, hFactor = 10 × σ) <em>and</em> EWMA is rising. These points signal a statistically significant sustained increase in event rates and should be investigated first.<br />
                            • <strong>Event severity weights</strong>: High = 4, Medium = 2, Low = 1. Daily total score reflects overall impact.<br />
                            • <strong>Recommended action</strong>: review operations and maintenance logs around alarm dates. If multiple consecutive alarms appear, escalate to safety review for proactive risk mitigation.<br />
                            • <strong>Parameters reference</strong>: α (EWMA smoothing factor) = 0.30, kFactor (CUSUM sensitivity) = 0.50, hFactor (CUSUM alarm threshold) = 10.0, window for EWMA trend comparison = 3 days.
                        </div>

                    </div>
                </div>



            </div>
        </div>
    </div>


    <div class="rowx footer">
        <div class=" col-lg-12 col-md-11 col-sm-11 col-xs-11" style="padding:0;">


            <table>
                <tr>
                    <td style="width:150px;text-align:right;padding-right:5px" class="dx-border"><div class="center" dx-date-box="date_from"></div></td>
                    <td style="width:150px;text-align:right;padding-right:5px" class="dx-border"><div class="center" dx-date-box="date_to"></div></td>

                    <td style="padding-right:3px;"> <div dx-button="btn_search"></div></td>

                </tr>
            </table>
        </div>
        <div style="clear:both"></div>
    </div>
    <div dx-load-panel="loadPanel"></div>
</div>